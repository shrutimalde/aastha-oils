<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aastha Oils Order Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.5.25/dist/jspdf.plugin.autotable.js"></script>
    <style>
        body {
            font-family: sans-serif;
            margin: 0 auto;
            padding: 20px;
        }

        .title {
            font-size: 24px;
            font-weight: 600;
            word-spacing: 1px;
            text-decoration: underline;
        }

        tfoot {
            background-color: #ddd;
            font-weight: bold;
        }

        .w-100 {
            width: 100px !important;
        }
    </style>
</head>

<body>
    <div class="container" id="orderFormContainer">
        <h1 class="text-primary title">AASTHA OILS ORDER FORM</h1>
        <form id="orderForm">
            <div class="row mt-4">
                <div class="col-md-6 col-sm-12 mt-3">
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="partyName" required>
                        <label for="partyName"> Party Name</label>
                    </div>
                </div>
                <div class="col-md-6 col-sm-12 mt-3">
                    <div class="form-floating mb-3">
                        <input type="date" class="form-control" id="orderDate" required>
                        <label for="orderDate"> Order Date</label>
                    </div>
                </div>
                <div class="col-md-6 col-sm-12 mt-3">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th colspan="3">Gagandip Oil</th>
                            </tr>
                            <tr>
                                <th>ML</th>
                                <th>Boxes</th>
                                <th>Free</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row" class="align-middle">900</th>
                                <td><input type="number" class="form-control w-100 gagandipOilBox"
                                        id="gagandipOil900Box" oninput="updateTotals('gagandipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipOilFree"
                                        id="gagandipOil900Free" oninput="updateTotals('gagandipOil')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">800</th>
                                <td><input type="number" class="form-control w-100 gagandipOilBox"
                                        id="gagandipOil800Box" oninput="updateTotals('gagandipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipOilFree"
                                        id="gagandipOil800Free" oninput="updateTotals('gagandipOil')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">450</th>
                                <td><input type="number" class="form-control w-100 gagandipOilBox"
                                        id="gagandipOil450Box" oninput="updateTotals('gagandipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipOilFree"
                                        id="gagandipOil450Free" oninput="updateTotals('gagandipOil')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">200</th>
                                <td><input type="number" class="form-control w-100 gagandipOilBox"
                                        id="gagandipOil200Box" oninput="updateTotals('gagandipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipOilFree"
                                        id="gagandipOil200Free" oninput="updateTotals('gagandipOil')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">150</th>
                                <td><input type="number" class="form-control w-100 gagandipOilBox"
                                        id="gagandipOil150Box" oninput="updateTotals('gagandipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipOilFree"
                                        id="gagandipOil150Free" oninput="updateTotals('gagandipOil')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">100</th>
                                <td><input type="number" class="form-control w-100 gagandipOilBox"
                                        id="gagandipOil100Box" oninput="updateTotals('gagandipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipOilFree"
                                        id="gagandipOil100Free" oninput="updateTotals('gagandipOil')">
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>Total</th>
                                <td><span id="gagandipOilTotalBoxes">0</span></td>
                                <td><span id="gagandipOilTotalFree">0</span></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="col-md-6 col-sm-12 mt-3">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th colspan="3">Gagandip Ghee</th>
                            </tr>
                            <tr>
                                <th>ML</th>
                                <th>Boxes</th>
                                <th>Free</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row" class="align-middle">1000</th>
                                <td><input type="number" class="form-control w-100 gagandipGheeBox"
                                        id="gagandipGhee1000Box" oninput="updateTotals('gagandipGhee')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipGheeFree"
                                        id="gagandipGhee1000Free" oninput="updateTotals('gagandipGhee')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">500</th>
                                <td><input type="number" class="form-control w-100 gagandipGheeBox"
                                        id="gagandipGhee500Box" oninput="updateTotals('gagandipGhee')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipGheeFree"
                                        id="gagandipGhee500Free" oninput="updateTotals('gagandipGhee')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">200</th>
                                <td><input type="number" class="form-control w-100 gagandipGheeBox"
                                        id="gagandipGhee200Box" oninput="updateTotals('gagandipGhee')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipGheeFree"
                                        id="gagandipGhee200Free" oninput="updateTotals('gagandipGhee')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">100</th>
                                <td><input type="number" class="form-control w-100 gagandipGheeBox"
                                        id="gagandipGhee100Box" oninput="updateTotals('gagandipGhee')">
                                </td>
                                <td><input type="number" class="form-control w-100 gagandipGheeFree"
                                        id="gagandipGhee100Free" oninput="updateTotals('gagandipGhee')">
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>Total</th>
                                <td><span id="gagandipGheeTotalBoxes">0</span></td>
                                <td><span id="gagandipGheeTotalFree">0</span></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="col-md-6 col-sm-12 mt-3">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Gagandip Soap (DZN - PCS)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="number" class="form-control w-100" id="gagandipSoap">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6 col-sm-12 mt-3">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th colspan="3">Pushpadip Oil</th>
                            </tr>
                            <tr>
                                <th>ML</th>
                                <th>Boxes</th>
                                <th>Free</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row" class="align-middle">900</th>
                                <td><input type="number" class="form-control w-100 pushpadipOilBox"
                                        id="pushpadipOil900Box" oninput="updateTotals('pushpadipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 pushpadipOilFree"
                                        id="pushpadipOil900Free" oninput="updateTotals('pushpadipOil')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">800</th>
                                <td><input type="number" class="form-control w-100 pushpadipOilBox"
                                        id="pushpadipOil800Box" oninput="updateTotals('pushpadipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 pushpadipOilFree"
                                        id="pushpadipOil800Free" oninput="updateTotals('pushpadipOil')">
                                </td>
                            </tr>
                            <tr>
                                <th scope="row" class="align-middle">450</th>
                                <td><input type="number" class="form-control w-100 pushpadipOilBox"
                                        id="pushpadipOil450Box" oninput="updateTotals('pushpadipOil')">
                                </td>
                                <td><input type="number" class="form-control w-100 pushpadipOilFree"
                                        id="pushpadipOil450Free" oninput="updateTotals('pushpadipOil')">
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>Total</th>
                                <td><span id="pushpadipOilTotalBoxes">0</span></td>
                                <td><span id="pushpadipOilTotalFree">0</span></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="col-md-12 col-sm-12 mt-3">
                    <div class="form-floating mb-3">
                        <textarea class="form-control" id="note" rows="3"></textarea>
                        <label for="note"> Note/ Special Instructions</label>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn btn-primary mt-3">Download PDF</button>
            <button type="button" class="btn btn-success mt-3 pl-2" onclick="shareOnWhatsApp()">Share on
                WhatsApp </button>
        </form>
    </div>
    <script>
        document.getElementById('orderDate').valueAsDate = new Date();
        function updateTotals(product) {
            let totalBoxes = 0;
            let totalFree = 0;

            const boxInputs = document.querySelectorAll(`.${product}Box`);
            const freeInputs = document.querySelectorAll(`.${product}Free`);

            boxInputs.forEach(input => {
                const value = parseInt(input.value) || 0;
                totalBoxes += value;
            });

            freeInputs.forEach(input => {
                const value = parseInt(input.value) || 0;
                totalFree += value;
            });

            document.getElementById(`${product}TotalBoxes`).textContent = totalBoxes;
            document.getElementById(`${product}TotalFree`).textContent = totalFree;
        }

        function shareOnWhatsApp() {
            // Get the values from the form inputs
            const partyName = document.getElementById('partyName').value;
            const orderDate = document.getElementById('orderDate').value;
            const note = document.getElementById('note').value;

            const gagandipOilData = [
                { ml: 900, boxes: document.getElementById('gagandipOil900Box').value, free: document.getElementById('gagandipOil900Free').value },
                { ml: 800, boxes: document.getElementById('gagandipOil800Box').value, free: document.getElementById('gagandipOil800Free').value },
                { ml: 450, boxes: document.getElementById('gagandipOil450Box').value, free: document.getElementById('gagandipOil450Free').value },
                { ml: 200, boxes: document.getElementById('gagandipOil200Box').value, free: document.getElementById('gagandipOil200Free').value },
                { ml: 150, boxes: document.getElementById('gagandipOil150Box').value, free: document.getElementById('gagandipOil150Free').value },
                { ml: 100, boxes: document.getElementById('gagandipOil100Box').value, free: document.getElementById('gagandipOil100Free').value }
            ];
            const gagandipGheeData = [
                { ml: 1000, boxes: document.getElementById('gagandipGhee1000Box').value, free: document.getElementById('gagandipGhee1000Free').value },
                { ml: 500, boxes: document.getElementById('gagandipGhee500Box').value, free: document.getElementById('gagandipGhee500Free').value },
                { ml: 200, boxes: document.getElementById('gagandipGhee200Box').value, free: document.getElementById('gagandipGhee200Free').value },
                { ml: 100, boxes: document.getElementById('gagandipGhee100Box').value, free: document.getElementById('gagandipGhee100Free').value }
            ];

            const gagandipSoap = document.getElementById('gagandipSoap').value;

            const pushpadipOilData = [
                { ml: 900, boxes: document.getElementById('pushpadipOil900Box').value, free: document.getElementById('pushpadipOil900Free').value },
                { ml: 800, boxes: document.getElementById('pushpadipOil800Box').value, free: document.getElementById('pushpadipOil800Free').value },
                { ml: 450, boxes: document.getElementById('pushpadipOil450Box').value, free: document.getElementById('pushpadipOil450Free').value },
            ];

            // Format the message string
            let message = `AASTHA OILS ORDER FORM\n\n` +
                `Party Name: ${partyName}\n` +
                `Order Date: ${orderDate}\n\n` +
                `Gagandip Oil:\n` +
                gagandipOilData.map(row => `- ${row.ml} ML: ${row.boxes} Boxes, ${row.free} Free`).join('\n') + `\n` +
                `Total Boxes: ${document.getElementById('gagandipOilTotalBoxes').textContent}, ` +
                `Total Free: ${document.getElementById('gagandipOilTotalFree').textContent}\n\n` +
                `Gagandip Ghee:\n` +
                gagandipGheeData.map(row => `- ${row.ml} ML: ${row.boxes} Boxes, ${row.free} Free`).join('\n') + `\n` +
                `Total Boxes: ${document.getElementById('gagandipGheeTotalBoxes').textContent}, ` +
                `Total Free: ${document.getElementById('gagandipGheeTotalFree').textContent}\n\n` +
                `Gagandip Soap:\n` +
                `- ${gagandipSoap} PCS\n\n` +
                `Pushpadip Oil:\n` +
                pushpadipOilData.map(row => `- ${row.ml} ML: ${row.boxes} Boxes, ${row.free} Free`).join('\n') + `\n` +
                `Total Boxes: ${document.getElementById('pushpadipOilTotalBoxes').textContent}, ` +
                `Total Free: ${document.getElementById('pushpadipOilTotalFree').textContent}\n\n` +
                `Note/ Special Instructions: ${note}`;

            // Encode the message for use in a URL
            const encodedMessage = encodeURIComponent(message);

            // Create the WhatsApp share link
            const whatsappLink = `https://api.whatsapp.com/send?text=${encodedMessage}`;

            // Redirect to the WhatsApp link (this will open WhatsApp with the pre-filled message)
            window.location.href = whatsappLink;
        }

        document.getElementById('orderForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const partyName = document.getElementById('partyName').value;
            const orderDate = document.getElementById('orderDate').value;
            const note = document.getElementById('note').value;

            const gagandipOilData = [
                { ml: 900, boxes: document.getElementById('gagandipOil900Box').value, free: document.getElementById('gagandipOil900Free').value },
                { ml: 800, boxes: document.getElementById('gagandipOil800Box').value, free: document.getElementById('gagandipOil800Free').value },
                { ml: 450, boxes: document.getElementById('gagandipOil450Box').value, free: document.getElementById('gagandipOil450Free').value },
                { ml: 200, boxes: document.getElementById('gagandipOil200Box').value, free: document.getElementById('gagandipOil200Free').value },
                { ml: 150, boxes: document.getElementById('gagandipOil150Box').value, free: document.getElementById('gagandipOil150Free').value },
                { ml: 100, boxes: document.getElementById('gagandipOil100Box').value, free: document.getElementById('gagandipOil100Free').value }
            ];
            const gagandipGheeData = [
                { ml: 1000, boxes: document.getElementById('gagandipGhee1000Box').value, free: document.getElementById('gagandipGhee1000Free').value },
                { ml: 500, boxes: document.getElementById('gagandipGhee500Box').value, free: document.getElementById('gagandipGhee500Free').value },
                { ml: 200, boxes: document.getElementById('gagandipGhee200Box').value, free: document.getElementById('gagandipGhee200Free').value },
                { ml: 100, boxes: document.getElementById('gagandipGhee100Box').value, free: document.getElementById('gagandipGhee100Free').value }
            ];

            const gagandipSoap = document.getElementById('gagandipSoap').value;

            const pushpadipOilData = [
                { ml: 900, boxes: document.getElementById('pushpadipOil900Box').value, free: document.getElementById('pushpadipOil900Free').value },
                { ml: 800, boxes: document.getElementById('pushpadipOil800Box').value, free: document.getElementById('pushpadipOil800Free').value },
                { ml: 450, boxes: document.getElementById('pushpadipOil450Box').value, free: document.getElementById('pushpadipOil450Free').value },
            ];

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Add title
            doc.setFontSize(18);
            doc.text('Aastha Oils Order Form', 14, 15);
            // Add party name and order date
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(12);
            doc.text(`Party Name:`, 14, 25);

            doc.setTextColor(41, 128, 185);
            doc.setFont("helvetica", "bold");
            doc.text(partyName, 40, 25);

            doc.setTextColor(0, 0, 0);
            doc.setFontSize(12);
            doc.setFont("helvetica", "normal");
            doc.text(`Order Date:`, 14, 32);

            doc.setTextColor(41, 128, 185);
            doc.setFont("helvetica", "bold");
            doc.text(orderDate, 40, 32);

            // Add Gagandip Oil table
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(14);
            doc.setFont("helvetica", "normal");
            doc.text('Gagandip Oil', 14, 45);
            doc.autoTable({
                head: [['ML', 'Boxes', 'Free']],
                body: [
                    ...gagandipOilData.map(row => [row.ml, row.boxes, row.free]),
                ],
                startY: 50,
                headStyles: { fillColor: [41, 128, 185], textColor: 255 },
                bodyStyles: { textColor: 0 },
                theme: 'grid',
                tableLineColor: [0, 0, 0],
                tableLineWidth: 0.1,
                foot: [['Total', document.getElementById('gagandipOilTotalBoxes').textContent, document.getElementById('gagandipOilTotalFree').textContent]],
                footStyles: { fillColor: [220, 220, 220], textColor: 0, fontStyle: 'bold' }
            });

            // Add Gagandip Ghee table
            const gheeTableY = doc.lastAutoTable.finalY + 15;
            doc.setFontSize(14);
            doc.text('Gagandip Ghee', 14, gheeTableY - 5);
            doc.autoTable({
                head: [['ML', 'Boxes', 'Free']],
                body: [
                    ...gagandipGheeData.map(row => [row.ml, row.boxes, row.free]),
                ],
                startY: gheeTableY,
                headStyles: { fillColor: [41, 128, 185], textColor: 255 },
                bodyStyles: { textColor: 0 },
                theme: 'grid',
                tableLineColor: [0, 0, 0],
                tableLineWidth: 0.1,
                foot: [['Total', document.getElementById('gagandipGheeTotalBoxes').textContent, document.getElementById('gagandipGheeTotalFree').textContent]],
                footStyles: { fillColor: [220, 220, 220], textColor: 0, fontStyle: 'bold' }
            });

            // Add Gagandip Soap
            const soapY = doc.lastAutoTable.finalY + 15;
            doc.setFontSize(14);
            doc.text('Gagandip Soap', 14, soapY - 5);
            doc.autoTable({
                head: [['Gagandip Soap (DZN - PCS)']],
                body: [[gagandipSoap]],
                startY: soapY,
                headStyles: { fillColor: [41, 128, 185], textColor: 255 },
                bodyStyles: { textColor: 0 },
                theme: 'grid',
                tableLineColor: [0, 0, 0],
                tableLineWidth: 0.1
            });

            //Add Pushpadip Oil
            const pushpadipOilY = doc.lastAutoTable.finalY + 15;
            doc.setFontSize(14);
            doc.text('Pushpadip Oil', 14, pushpadipOilY - 5);
            doc.autoTable({
                head: [['ML', 'Boxes', 'Free']],
                body: [
                    ...pushpadipOilData.map(row => [row.ml, row.boxes, row.free]),
                ],
                startY: pushpadipOilY,
                headStyles: { fillColor: [41, 128, 185], textColor: 255 },
                bodyStyles: { textColor: 0 },
                theme: 'grid',
                tableLineColor: [0, 0, 0],
                tableLineWidth: 0.1,
                foot: [['Total', document.getElementById('pushpadipOilTotalBoxes').textContent, document.getElementById('pushpadipOilTotalFree').textContent]],
                footStyles: { fillColor: [220, 220, 220], textColor: 0, fontStyle: 'bold' }
            });

            doc.setFontSize(12);
            const noteY = doc.lastAutoTable.finalY + 15;
            doc.text(`Note/ Special Instructions: `, 14, noteY - 5);
            const lines = doc.splitTextToSize(note, 180);
            doc.setTextColor(41, 128, 185);
            doc.text(lines, 14, noteY + 1);


            doc.save(`${partyName} - ${orderDate}.pdf`);
        });
    </script>
</body>

</html>
